const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ConfigDialog-BaiTIV8i.js","assets/ui-DXEsCjYO.js","assets/vendor-B6OAZll8.js","assets/icons-Bi8i6cou.js","assets/useConnection-h2CLINrd.js","assets/state-BMzes8HB.js","assets/sdk-9Bd1H_oq.js","assets/utils-E4Pq5uL6.js","assets/ConfigDialog-lAzma1m8.css","assets/VoiceControls-B1uX5VXO.js","assets/useSTT-BoXeMwAR.js","assets/VoiceControls-CAbPtU9N.css","assets/UploadDropzone-WEb30E3B.js","assets/UploadDropzone-D52-VAZR.css","assets/ChatMessageList-0KrhddxG.js","assets/audio-B1K76-a3.js","assets/ChatMessageList-7A8d2XHD.css"])))=>i.map(i=>d[i]);
import{t as F,c as L,j as e,S as V,a as T}from"./ui-DXEsCjYO.js";import{b as $,r as p}from"./vendor-B6OAZll8.js";import{R as j,a as M,b as R,c as w,d as z}from"./state-BMzes8HB.js";import{t as k,T as B}from"./utils-E4Pq5uL6.js";import{I as D,a as b,b as q,c as J}from"./icons-Bi8i6cou.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))c(t);new MutationObserver(t=>{for(const s of t)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&c(i)}).observe(document,{childList:!0,subtree:!0});function n(t){const s={};return t.integrity&&(s.integrity=t.integrity),t.referrerPolicy&&(s.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?s.credentials="include":t.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function c(t){if(t.ep)return;t.ep=!0;const s=n(t);fetch(t.href,s)}})();var A,K=$;A=K.createRoot,K.hydrateRoot;const H="modulepreload",W=function(o){return"/aiola-voice-api-app/"+o},E={},S=function(a,n,c){let t=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),d=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));t=Promise.allSettled(n.map(h=>{if(h=W(h),h in E)return;E[h]=!0;const f=h.endsWith(".css"),_=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${_}`))return;const u=document.createElement("link");if(u.rel=f?"stylesheet":H,f||(u.as="script"),u.crossOrigin="",u.href=h,d&&u.setAttribute("nonce",d),document.head.appendChild(u),f)return new Promise((y,v)=>{u.addEventListener("load",y),u.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${h}`)))})}))}function s(i){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=i,window.dispatchEvent(d),!d.defaultPrevented)throw i}return t.then(i=>{for(const d of i||[])d.status==="rejected"&&s(d.reason);return a().catch(s)})},O=j({key:"conversationState",default:{id:"default",messages:[]}});function N(...o){return F(L(o))}function I(o,...a){const n=o.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();return N(n,...a)}function xe(o){if(!o||o<=0)return"0s";const a=o/1e3,n=Math.floor(a/3600),c=Math.floor(a%3600/60),t=a%60;return n>0?`${n}h ${c}m`:c>0?`${c}m ${Math.floor(t)}s`:`${t.toFixed(1)}s`}const Z=T("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),P=p.forwardRef(({className:o,variant:a,size:n,asChild:c=!1,...t},s)=>{const i=c?V:"button";return e.jsx(i,{className:I("Button",N(Z({variant:a,size:n,className:o}))),ref:s,...t})});P.displayName="Button";function G({children:o,content:a,className:n}){const[c,t]=p.useState(!1);return e.jsxs("div",{className:N("relative inline-block",n),onMouseEnter:()=>t(!0),onMouseLeave:()=>t(!1),onClick:()=>t(!c),children:[o,c&&e.jsxs("div",{className:"absolute top-full right-0 transform translate-x-0 mt-2 px-3 py-2 bg-gray-900 text-white text-xs rounded shadow-lg z-10 whitespace-pre-line max-w-sm min-w-[120px]",children:[a,e.jsx("div",{className:"absolute bottom-full right-0 transform translate-x-0 w-0 h-0 border-l-2 border-r-2 border-b-2 border-transparent border-b-gray-900"})]})]})}const l={environment:"prod",prod:{connection:{apiKey:"",baseUrl:"https://apis.aiola.ai",authBaseUrl:"https://auth.aiola.ai",workflowId:""},stt:{language:"en_US",keywords:[],vad:"default",rememberFlowid:!0},tts:{voice:"tara",language:"en"}},dev:{connection:{apiKey:"",baseUrl:"https://dev-vp1-uw2-api.internal.aiola.ai",authBaseUrl:"https://dev-vp1-uw2-auth.internal.aiola.ai",workflowId:""},stt:{language:"en_US",keywords:[],vad:"default",rememberFlowid:!0},tts:{voice:"tara",language:"en"}}};function C(){var o,a,n,c,t,s,i,d,h,f,_,u,y;if(typeof window>"u"||typeof localStorage>"u")return l;try{const v=localStorage.getItem("aiola-settings");if(v){const r=JSON.parse(v);if(r.connection&&typeof r.connection.apiKey=="string"){console.log("[loadSettingsFromStorage] Migrating from old settings format");const g={environment:r.environment||"prod",prod:{connection:{apiKey:r.connection.apiKey||"",baseUrl:"https://apis.aiola.ai",authBaseUrl:"https://auth.aiola.ai",workflowId:((o=r.stt)==null?void 0:o.flowid)||""},stt:{language:((a=r.stt)==null?void 0:a.language)||"en_US",keywords:((n=r.stt)==null?void 0:n.keywords)||[],vad:"default",rememberFlowid:((c=r.stt)==null?void 0:c.rememberFlowid)!==!1},tts:{voice:((t=r.tts)==null?void 0:t.voice)||"tara",language:"en"}},dev:{connection:{apiKey:"",baseUrl:"https://dev-vp1-uw2-api.internal.aiola.ai",authBaseUrl:"https://dev-vp1-uw2-auth.internal.aiola.ai",workflowId:""},stt:{language:"en_US",keywords:[],vad:"default",rememberFlowid:!0},tts:{voice:"tara",language:"en"}}};return localStorage.setItem("aiola-settings",JSON.stringify(g)),console.log("[loadSettingsFromStorage] Settings migrated and loaded"),g}if((i=(s=r.prod)==null?void 0:s.connection)!=null&&i.apiKey){const g=r.prod.connection.apiKey;(typeof g!="string"||g.includes("authorization Bearer")||g.includes('{"connection":'))&&(console.warn("Corrupted apiKey detected in localStorage, clearing it"),r.prod.connection.apiKey="",localStorage.setItem("aiola-settings",JSON.stringify({...l,...r,prod:{...l.prod,...r.prod,connection:{...l.prod.connection,...(d=r.prod)==null?void 0:d.connection,apiKey:""}}})))}if((f=(h=r.dev)==null?void 0:h.connection)!=null&&f.apiKey){const g=r.dev.connection.apiKey;(typeof g!="string"||g.includes("authorization Bearer")||g.includes('{"connection":'))&&(console.warn("Corrupted dev apiKey detected in localStorage, clearing it"),r.dev.connection.apiKey="",localStorage.setItem("aiola-settings",JSON.stringify({...l,...r,dev:{...l.dev,...r.dev,connection:{...l.dev.connection,...(_=r.dev)==null?void 0:_.connection,apiKey:""}}})))}const m={...l,...r,prod:{...l.prod,...r.prod||{},connection:{...l.prod.connection,...((u=r.prod)==null?void 0:u.connection)||{}}},dev:{...l.dev,...r.dev||{},connection:{...l.dev.connection,...((y=r.dev)==null?void 0:y.connection)||{}}}};return console.log("[loadSettingsFromStorage] Settings loaded from localStorage:",{environment:m.environment,hasProdApiKey:!!m.prod.connection.apiKey,hasDevApiKey:!!m.dev.connection.apiKey,prodSttLanguage:m.prod.stt.language,prodTtsVoice:m.prod.tts.voice,devSttLanguage:m.dev.stt.language,devTtsVoice:m.dev.tts.voice,source:"localStorage"}),m}}catch(v){console.warn("Failed to load settings from localStorage:",v),console.log("[loadSettingsFromStorage] Using default settings due to error")}return console.log("[loadSettingsFromStorage] No saved settings found, using defaults"),l}function Q(){return typeof window<"u"&&typeof localStorage<"u"?C():l}M({key:"settingsSelector",get:()=>C()});const U=j({key:"settingsState",default:Q()});function X(){return R(U)}function Y(){const[,o]=R(U);return p.useEffect(()=>{const a=setTimeout(()=>{const n=C(),c={apiKey:n[n.environment].connection.apiKey,stt:n[n.environment].stt,tts:n[n.environment].tts};console.log("[SettingsInitializer] Settings loaded from localStorage:",{environment:n.environment,hasApiKey:!!c.apiKey,sttLanguage:c.stt.language,ttsVoice:c.tts.voice,rememberFlowid:c.stt.rememberFlowid}),o(n)},100);return()=>clearTimeout(a)},[o]),null}const ee=j({key:"audioState",default:{micAllowed:!1,isRecording:!1,isTranscribing:!1,microphoneState:"idle",partialText:"",playingMessageId:void 0,currentRecordingMessageId:void 0,startedAtMs:0,elapsedMs:0,sttRequestStartedAtMs:0,sttRequestElapsedMs:0,currentSessionId:void 0,cancelFunction:void 0,cancelChatFunction:void 0}}),te={"@aiola/sdk":"^2.1.4"},oe={dependencies:te},ne="0.0.1",ae=oe.dependencies["@aiola/sdk"].replace("^","");function re(o){const a=o.environment;return{apiKey:o[a].connection.apiKey,baseUrl:o[a].connection.baseUrl,authBaseUrl:o[a].connection.authBaseUrl,workflowId:o[a].connection.workflowId,environment:a,stt:o[a].stt,tts:o[a].tts}}const se=ne;function ie({onSettingsClick:o}){const[a]=X(),n=re(a),c=w(O),t=w(ee);console.log("ChatHeader settings:",a),console.log("ChatHeader currentSettings:",n);const s=async(i,d)=>{try{await navigator.clipboard.writeText(i),k.success(`${d} copied to clipboard`),console.log(`${d} copied to clipboard`)}catch(h){console.error("Failed to copy:",h),k.error("Failed to copy to clipboard")}};return e.jsx("header",{className:I("ChatHeader","chat-header"),children:e.jsxs("div",{className:"chat-header__container",children:[e.jsxs("div",{className:"chat-header__left-section",children:[e.jsx("div",{className:"chat-header__content",children:e.jsxs("div",{className:"chat-header__title-row",children:[e.jsx("h1",{className:"chat-header__title",children:"aiOla Voice Api APP"}),e.jsx("div",{className:"chat-header__environment-chip",children:n.environment.toUpperCase()}),e.jsx("div",{className:"chat-header__status",children:e.jsxs("div",{className:"chat-header__microphone-status",children:[e.jsx(D,{className:`chat-header__microphone-indicator ${t.microphoneState==="connected"?"chat-header__microphone-indicator--connected":t.microphoneState==="ready"?"chat-header__microphone-indicator--ready":t.microphoneState==="connecting"?"chat-header__microphone-indicator--connecting":t.microphoneState==="preparingMic"?"chat-header__microphone-indicator--preparingMic":"chat-header__microphone-indicator--idle"}`}),e.jsx("span",{className:`chat-header__microphone-text ${t.microphoneState==="connected"?"chat-header__microphone-text--connected":t.microphoneState==="ready"?"chat-header__microphone-text--ready":t.microphoneState==="connecting"?"chat-header__microphone-text--connecting":t.microphoneState==="preparingMic"?"chat-header__microphone-text--preparingMic":"chat-header__microphone-text--idle"}`,children:t.microphoneState==="connected"?"Recording":t.microphoneState==="ready"?"Ready":t.microphoneState==="connecting"?"Connecting":t.microphoneState==="preparingMic"?"Preparing Mic":"Idle"})]})})]})}),e.jsx("div",{className:"chat-header__content-below",children:e.jsxs("div",{className:"chat-header__connection-info",children:[e.jsxs("div",{className:"chat-header__connection-item",children:[e.jsx("span",{className:"chat-header__connection-label",children:"API Key:"}),e.jsx("span",{className:"chat-header__connection-value",children:n.apiKey?`...${n.apiKey.slice(-15)}`:"Not set"}),n.apiKey&&e.jsx(b,{className:"chat-header__copy-icon",onClick:()=>s(n.apiKey,"API Key")})]}),e.jsxs("div",{className:"chat-header__connection-item",children:[e.jsx("span",{className:"chat-header__connection-label",children:"Workflow Id:"}),e.jsx("span",{className:"chat-header__connection-value",children:n.workflowId||"default"}),n.workflowId&&e.jsx(b,{className:"chat-header__copy-icon",onClick:()=>s(n.workflowId||"","Workflow Id")})]}),e.jsxs("div",{className:"chat-header__connection-item",children:[e.jsx("span",{className:"chat-header__connection-label",children:"Session:"}),e.jsx("span",{className:"chat-header__connection-value",children:t.currentSessionId?`...${t.currentSessionId.slice(-16)}`:"connection requiredâ—ï¸"}),e.jsx(b,{className:"chat-header__copy-icon",onClick:()=>s(t.currentSessionId||c.id,"Session")})]}),e.jsxs("div",{className:"chat-header__connection-item",children:[e.jsx("span",{className:"chat-header__connection-label",children:"Execution Id:"}),e.jsx("span",{className:"chat-header__connection-value",children:"TBD ðŸš§"})]})]})})]}),e.jsx("div",{className:"chat-header__actions",children:e.jsx(P,{variant:"ghost",size:"default",onClick:o,className:"chat-header__settings-button",children:e.jsx(q,{})})}),e.jsx(G,{className:"chat-header__version-icon",content:`version: ${se}
aiOlaSDK: ${ae}`,children:e.jsx(J,{})})]})})}const ce=p.lazy(()=>S(()=>import("./ConfigDialog-BaiTIV8i.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8])).then(o=>({default:o.ConfigDialog}))),de=p.lazy(()=>S(()=>import("./VoiceControls-B1uX5VXO.js"),__vite__mapDeps([9,1,2,5,4,6,7,10,3,11])).then(o=>({default:o.VoiceControls}))),le=p.lazy(()=>S(()=>import("./UploadDropzone-WEb30E3B.js"),__vite__mapDeps([12,1,2,5,10,4,6,7,3,13])).then(o=>({default:o.UploadDropzone}))),he=p.lazy(()=>S(()=>import("./ChatMessageList-0KrhddxG.js"),__vite__mapDeps([14,1,2,5,15,3,4,6,7,16])).then(o=>({default:o.ChatMessageList}))),x=()=>e.jsx("div",{className:"flex items-center justify-center p-4",children:e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-primary"})});function pe(){const[o,a]=p.useState(!1),n=w(O);return e.jsxs("div",{className:I("Chat","chat-page"),children:[e.jsx("div",{className:"chat-page__header",children:e.jsx(ie,{onSettingsClick:()=>a(!0)})}),e.jsxs("div",{className:"chat-page__main",children:[o&&e.jsx(p.Suspense,{fallback:e.jsx(x,{}),children:e.jsx(ce,{open:o,onOpenChange:a})}),e.jsx("div",{className:"chat-page__messages-area",children:e.jsx("div",{className:"chat-page__messages-container",children:e.jsx(p.Suspense,{fallback:e.jsx(x,{}),children:e.jsx(he,{messages:n.messages})})})}),e.jsxs("div",{className:"chat-page__controls-content",children:[e.jsx("div",{className:"chat-page__upload-dropzone",children:e.jsx(p.Suspense,{fallback:e.jsx(x,{}),children:e.jsx(le,{})})}),e.jsx("div",{className:"chat-page__voice-controls",children:e.jsx(p.Suspense,{fallback:e.jsx(x,{}),children:e.jsx(de,{})})})]})]})]})}const ue=({...o})=>e.jsx(B,{theme:"light",className:"toaster group",position:"top-right",dir:"ltr",toastOptions:{classNames:{toast:"group toast !bg-white !text-gray-900 !border-gray-200 shadow-lg animate-in slide-in-from-right-full !w-80 min-w-[200px]",description:"group-[.toast]:!text-gray-700",actionButton:"group-[.toast]:!bg-gray-800 group-[.toast]:!text-white hover:group-[.toast]:!bg-gray-700",cancelButton:"group-[.toast]:!bg-gray-100 group-[.toast]:!text-gray-800 hover:group-[.toast]:!bg-gray-200"}},...o});function ge(){return e.jsxs(z,{children:[e.jsx(Y,{}),e.jsxs("div",{className:"min-h-screen",style:{backgroundColor:"#d1d5db"},children:[e.jsx(pe,{}),e.jsx(ue,{position:"top-right",style:{marginTop:"40px",marginRight:"50px"}})]})]})}document.title="aiOla Voice API App";A(document.getElementById("root")).render(e.jsx(p.StrictMode,{children:e.jsx(ge,{})}));export{P as B,N as a,ee as b,I as c,O as d,xe as f,U as s,X as u};
