const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ConfigDialog-BoGuaSxt.js","assets/ui-DXEsCjYO.js","assets/vendor-B6OAZll8.js","assets/icons-KOPessbp.js","assets/useConnection-NXU-bj3v.js","assets/state-BMzes8HB.js","assets/sdk-9Bd1H_oq.js","assets/utils-E4Pq5uL6.js","assets/ConfigDialog-LSQq74eq.css","assets/VoiceControls-CX19LT_p.js","assets/useSTT-BP0_Uc2C.js","assets/VoiceControls-CAbPtU9N.css","assets/UploadDropzone-DpS7y3xP.js","assets/UploadDropzone-D52-VAZR.css","assets/ChatMessageList-DjbrPLIT.js","assets/audio-B1K76-a3.js","assets/ChatMessageList--g-DVnDa.css"])))=>i.map(i=>d[i]);
import{t as F,c as L,j as e,S as O,a as T}from"./ui-DXEsCjYO.js";import{b as B,r as p}from"./vendor-B6OAZll8.js";import{R as b,a as V,b as k,c as j,d as z}from"./state-BMzes8HB.js";import{I as M,a as w,b as $}from"./icons-KOPessbp.js";import{T as D}from"./utils-E4Pq5uL6.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))c(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&c(i)}).observe(document,{childList:!0,subtree:!0});function o(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function c(n){if(n.ep)return;n.ep=!0;const s=o(n);fetch(n.href,s)}})();var E,C=B;E=C.createRoot,C.hydrateRoot;const q="modulepreload",H=function(t){return"/aiola-voice-api-app/"+t},K={},S=function(a,o,c){let n=Promise.resolve();if(o&&o.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),d=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));n=Promise.allSettled(o.map(h=>{if(h=H(h),h in K)return;K[h]=!0;const f=h.endsWith(".css"),_=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${_}`))return;const u=document.createElement("link");if(u.rel=f?"stylesheet":q,f||(u.as="script"),u.crossOrigin="",u.href=h,d&&u.setAttribute("nonce",d),document.head.appendChild(u),f)return new Promise((y,v)=>{u.addEventListener("load",y),u.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${h}`)))})}))}function s(i){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=i,window.dispatchEvent(d),!d.defaultPrevented)throw i}return n.then(i=>{for(const d of i||[])d.status==="rejected"&&s(d.reason);return a().catch(s)})},A=b({key:"conversationState",default:{id:"default",messages:[]}});function R(...t){return F(L(t))}function N(t,...a){const o=t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();return R(o,...a)}function ge(t){if(!t||t<=0)return"0s";const a=t/1e3,o=Math.floor(a/3600),c=Math.floor(a%3600/60),n=a%60;return o>0?`${o}h ${c}m`:c>0?`${c}m ${Math.floor(n)}s`:`${n.toFixed(1)}s`}const J=T("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),P=p.forwardRef(({className:t,variant:a,size:o,asChild:c=!1,...n},s)=>{const i=c?O:"button";return e.jsx(i,{className:N("Button",R(J({variant:a,size:o,className:t}))),ref:s,...n})});P.displayName="Button";const l={environment:"prod",prod:{connection:{apiKey:"",baseUrl:"https://apis.aiola.ai",authBaseUrl:"https://auth.aiola.ai",workflowId:""},stt:{language:"en_US",keywords:[],vad:"default",rememberFlowid:!0},tts:{voice:"tara",language:"en"}},dev:{connection:{apiKey:"",baseUrl:"https://dev-vp1-uw2-api.internal.aiola.ai",authBaseUrl:"https://dev-vp1-uw2-auth.internal.aiola.ai",workflowId:""},stt:{language:"en_US",keywords:[],vad:"default",rememberFlowid:!0},tts:{voice:"tara",language:"en"}}};function I(){var t,a,o,c,n,s,i,d,h,f,_,u,y;if(typeof window>"u"||typeof localStorage>"u")return l;try{const v=localStorage.getItem("aiola-settings");if(v){const r=JSON.parse(v);if(r.connection&&typeof r.connection.apiKey=="string"){console.log("[loadSettingsFromStorage] Migrating from old settings format");const g={environment:r.environment||"prod",prod:{connection:{apiKey:r.connection.apiKey||"",baseUrl:"https://apis.aiola.ai",authBaseUrl:"https://auth.aiola.ai",workflowId:((t=r.stt)==null?void 0:t.flowid)||""},stt:{language:((a=r.stt)==null?void 0:a.language)||"en_US",keywords:((o=r.stt)==null?void 0:o.keywords)||[],vad:"default",rememberFlowid:((c=r.stt)==null?void 0:c.rememberFlowid)!==!1},tts:{voice:((n=r.tts)==null?void 0:n.voice)||"tara",language:"en"}},dev:{connection:{apiKey:"",baseUrl:"https://dev-vp1-uw2-api.internal.aiola.ai",authBaseUrl:"https://dev-vp1-uw2-auth.internal.aiola.ai",workflowId:""},stt:{language:"en_US",keywords:[],vad:"default",rememberFlowid:!0},tts:{voice:"tara",language:"en"}}};return localStorage.setItem("aiola-settings",JSON.stringify(g)),console.log("[loadSettingsFromStorage] Settings migrated and loaded"),g}if((i=(s=r.prod)==null?void 0:s.connection)!=null&&i.apiKey){const g=r.prod.connection.apiKey;(typeof g!="string"||g.includes("authorization Bearer")||g.includes('{"connection":'))&&(console.warn("Corrupted apiKey detected in localStorage, clearing it"),r.prod.connection.apiKey="",localStorage.setItem("aiola-settings",JSON.stringify({...l,...r,prod:{...l.prod,...r.prod,connection:{...l.prod.connection,...(d=r.prod)==null?void 0:d.connection,apiKey:""}}})))}if((f=(h=r.dev)==null?void 0:h.connection)!=null&&f.apiKey){const g=r.dev.connection.apiKey;(typeof g!="string"||g.includes("authorization Bearer")||g.includes('{"connection":'))&&(console.warn("Corrupted dev apiKey detected in localStorage, clearing it"),r.dev.connection.apiKey="",localStorage.setItem("aiola-settings",JSON.stringify({...l,...r,dev:{...l.dev,...r.dev,connection:{...l.dev.connection,...(_=r.dev)==null?void 0:_.connection,apiKey:""}}})))}const m={...l,...r,prod:{...l.prod,...r.prod||{},connection:{...l.prod.connection,...((u=r.prod)==null?void 0:u.connection)||{}}},dev:{...l.dev,...r.dev||{},connection:{...l.dev.connection,...((y=r.dev)==null?void 0:y.connection)||{}}}};return console.log("[loadSettingsFromStorage] Settings loaded from localStorage:",{environment:m.environment,hasProdApiKey:!!m.prod.connection.apiKey,hasDevApiKey:!!m.dev.connection.apiKey,prodSttLanguage:m.prod.stt.language,prodTtsVoice:m.prod.tts.voice,devSttLanguage:m.dev.stt.language,devTtsVoice:m.dev.tts.voice,source:"localStorage"}),m}}catch(v){console.warn("Failed to load settings from localStorage:",v),console.log("[loadSettingsFromStorage] Using default settings due to error")}return console.log("[loadSettingsFromStorage] No saved settings found, using defaults"),l}function W(){return typeof window<"u"&&typeof localStorage<"u"?I():l}V({key:"settingsSelector",get:()=>I()});const U=b({key:"settingsState",default:W()});function Z(){return k(U)}function G(){const[,t]=k(U);return p.useEffect(()=>{const a=setTimeout(()=>{const o=I(),c={apiKey:o[o.environment].connection.apiKey,stt:o[o.environment].stt,tts:o[o.environment].tts};console.log("[SettingsInitializer] Settings loaded from localStorage:",{environment:o.environment,hasApiKey:!!c.apiKey,sttLanguage:c.stt.language,ttsVoice:c.tts.voice,rememberFlowid:c.stt.rememberFlowid}),t(o)},100);return()=>clearTimeout(a)},[t]),null}const Q=b({key:"audioState",default:{micAllowed:!1,isRecording:!1,isTranscribing:!1,microphoneState:"idle",partialText:"",playingMessageId:void 0,currentRecordingMessageId:void 0,startedAtMs:0,elapsedMs:0,sttRequestStartedAtMs:0,sttRequestElapsedMs:0,currentSessionId:void 0,cancelFunction:void 0,cancelChatFunction:void 0}}),X="0.0.1";function Y(t){const a=t.environment;return{apiKey:t[a].connection.apiKey,baseUrl:t[a].connection.baseUrl,authBaseUrl:t[a].connection.authBaseUrl,workflowId:t[a].connection.workflowId,environment:a,stt:t[a].stt,tts:t[a].tts}}const ee=X;function te({onSettingsClick:t}){const[a]=Z(),o=Y(a),c=j(A),n=j(Q);console.log("ChatHeader settings:",a),console.log("ChatHeader currentSettings:",o);const s=async(i,d)=>{try{await navigator.clipboard.writeText(i),console.log(`${d} copied to clipboard`)}catch(h){console.error("Failed to copy:",h)}};return e.jsx("header",{className:N("ChatHeader","chat-header"),children:e.jsxs("div",{className:"chat-header__container",children:[e.jsxs("div",{className:"chat-header__left-section",children:[e.jsx("div",{className:"chat-header__content",children:e.jsxs("div",{className:"chat-header__title-row",children:[e.jsx("h1",{className:"chat-header__title",children:"Aiola Voice-Api APP"}),e.jsx("div",{className:"chat-header__environment-chip",children:o.environment.toUpperCase()}),e.jsx("div",{className:"chat-header__status",children:e.jsxs("div",{className:"chat-header__microphone-status",children:[e.jsx(M,{className:`chat-header__microphone-indicator ${n.microphoneState==="connected"?"chat-header__microphone-indicator--connected":n.microphoneState==="ready"?"chat-header__microphone-indicator--ready":n.microphoneState==="connecting"?"chat-header__microphone-indicator--connecting":n.microphoneState==="preparingMic"?"chat-header__microphone-indicator--preparingMic":"chat-header__microphone-indicator--idle"}`}),e.jsx("span",{className:`chat-header__microphone-text ${n.microphoneState==="connected"?"chat-header__microphone-text--connected":n.microphoneState==="ready"?"chat-header__microphone-text--ready":n.microphoneState==="connecting"?"chat-header__microphone-text--connecting":n.microphoneState==="preparingMic"?"chat-header__microphone-text--preparingMic":"chat-header__microphone-text--idle"}`,children:n.microphoneState==="connected"?"Recording":n.microphoneState==="ready"?"Ready":n.microphoneState==="connecting"?"Connecting":n.microphoneState==="preparingMic"?"Preparing Mic":"Idle"})]})})]})}),e.jsx("div",{className:"chat-header__content-below",children:e.jsxs("div",{className:"chat-header__connection-info",children:[e.jsxs("div",{className:"chat-header__connection-item",children:[e.jsx("span",{className:"chat-header__connection-label",children:"API Key:"}),e.jsx("span",{className:"chat-header__connection-value",children:o.apiKey?`...${o.apiKey.slice(-15)}`:"Not set"}),o.apiKey&&e.jsx(w,{className:"chat-header__copy-icon",onClick:()=>s(o.apiKey,"API Key")})]}),e.jsxs("div",{className:"chat-header__connection-item",children:[e.jsx("span",{className:"chat-header__connection-label",children:"Workflow Id:"}),e.jsx("span",{className:"chat-header__connection-value",children:o.workflowId||"default"}),o.workflowId&&e.jsx(w,{className:"chat-header__copy-icon",onClick:()=>s(o.workflowId,"Workflow Id")})]}),e.jsxs("div",{className:"chat-header__connection-item",children:[e.jsx("span",{className:"chat-header__connection-label",children:"Session:"}),e.jsx("span",{className:"chat-header__connection-value",children:n.currentSessionId?`...${n.currentSessionId.slice(-16)}`:"connection requiredâ—ï¸"}),e.jsx(w,{className:"chat-header__copy-icon",onClick:()=>s(n.currentSessionId||c.id,"Session")})]}),e.jsxs("div",{className:"chat-header__connection-item",children:[e.jsx("span",{className:"chat-header__connection-label",children:"Execution Id:"}),e.jsx("span",{className:"chat-header__connection-value",children:"TBD ðŸš§"})]})]})})]}),e.jsxs("div",{className:"chat-header__actions",children:[e.jsxs("div",{className:"chat-header__version",children:["v",ee]}),e.jsx(P,{variant:"ghost",size:"default",onClick:t,className:"chat-header__settings-button",children:e.jsx($,{})})]})]})})}const ne=p.lazy(()=>S(()=>import("./ConfigDialog-BoGuaSxt.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8])).then(t=>({default:t.ConfigDialog}))),oe=p.lazy(()=>S(()=>import("./VoiceControls-CX19LT_p.js"),__vite__mapDeps([9,1,2,5,4,6,7,10,3,11])).then(t=>({default:t.VoiceControls}))),ae=p.lazy(()=>S(()=>import("./UploadDropzone-DpS7y3xP.js"),__vite__mapDeps([12,1,2,5,10,4,6,7,3,13])).then(t=>({default:t.UploadDropzone}))),re=p.lazy(()=>S(()=>import("./ChatMessageList-DjbrPLIT.js"),__vite__mapDeps([14,1,2,15,3,5,4,6,7,16])).then(t=>({default:t.ChatMessageList}))),x=()=>e.jsx("div",{className:"flex items-center justify-center p-4",children:e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-primary"})});function se(){const[t,a]=p.useState(!1),o=j(A);return e.jsxs("div",{className:N("Chat","chat-page"),children:[e.jsx("div",{className:"chat-page__header",children:e.jsx(te,{onSettingsClick:()=>a(!0)})}),e.jsxs("div",{className:"chat-page__main",children:[t&&e.jsx(p.Suspense,{fallback:e.jsx(x,{}),children:e.jsx(ne,{open:t,onOpenChange:a})}),e.jsx("div",{className:"chat-page__messages-area",children:e.jsx("div",{className:"chat-page__messages-container",children:e.jsx(p.Suspense,{fallback:e.jsx(x,{}),children:e.jsx(re,{messages:o.messages})})})}),e.jsxs("div",{className:"chat-page__controls-content",children:[e.jsx("div",{className:"chat-page__upload-dropzone",children:e.jsx(p.Suspense,{fallback:e.jsx(x,{}),children:e.jsx(ae,{})})}),e.jsx("div",{className:"chat-page__voice-controls",children:e.jsx(p.Suspense,{fallback:e.jsx(x,{}),children:e.jsx(oe,{})})})]})]})]})}const ie=({...t})=>e.jsx(D,{theme:"light",className:"toaster group",position:"top-right",dir:"ltr",toastOptions:{classNames:{toast:"group toast !bg-white !text-gray-900 !border-gray-200 shadow-lg animate-in slide-in-from-right-full !w-80 min-w-[200px]",description:"group-[.toast]:!text-gray-700",actionButton:"group-[.toast]:!bg-gray-800 group-[.toast]:!text-white hover:group-[.toast]:!bg-gray-700",cancelButton:"group-[.toast]:!bg-gray-100 group-[.toast]:!text-gray-800 hover:group-[.toast]:!bg-gray-200"}},...t});function ce(){return e.jsxs(z,{children:[e.jsx(G,{}),e.jsxs("div",{className:"min-h-screen",style:{backgroundColor:"#d1d5db"},children:[e.jsx(se,{}),e.jsx(ie,{position:"top-right",style:{marginTop:"40px",marginRight:"50px"}})]})]})}document.title="Aiola Voice API App";E(document.getElementById("root")).render(e.jsx(p.StrictMode,{children:e.jsx(ce,{})}));export{P as B,R as a,Q as b,N as c,A as d,ge as f,U as s,Z as u};
